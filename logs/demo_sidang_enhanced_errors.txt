--- 2025-07-14T14:41:58.453377 ---
ERROR: Command failed: Running quick training
DETAILS:
  Command: python src/main_config.py --config config/quick_demo_config.yaml
  Output:
  📁 Experiment Directory: Training_Sessions/ProperTraining_1Epochs_20250714_1441/NF-CSE-CIC-IDS2018-v2/|Demo|
  📂 Log Files: ['source_trained', 'val_performance', 'target_performance', 'clustering', 'training', 'final_val', 'final_target']
  Using device: cuda
  ================================================================================
  🚀 MoMLNIDS Training Configuration
  ================================================================================
  📊 Project: MoMLNIDS_Demo
  🎯 Target Index: 0 (NF-CSE-CIC-IDS2018-v2)
  🔬 Experiment: |Demo|
  📈 Epochs: 1
  📦 Batch Size: 4
  ⚡ Learning Rate: 0.001
  🧠 Model: Single Layer=True, Input Nodes=39
  🔄 Use Clustering: False
  💾 Models Dir: Training_Sessions/ProperTraining_1Epochs_20250714_1441/NF-CSE-CIC-IDS2018-v2/|Demo|
  📝 Logs Dir: Training_Sessions/ProperTraining_1Epochs_20250714_1441/NF-CSE-CIC-IDS2018-v2/|Demo|
  ================================================================================
  📂 Loading data from: ./data/parquet/
  ✅ Data path exists: data/parquet
  📁 Found NF-CSE-CIC-IDS2018-v2: 187 parquet files
  📁 Found NF-ToN-IoT-v2: 169 parquet files
  📁 Found NF-UNSW-NB15-v2: 23 parquet files
  🎯 Available datasets: ['NF-CSE-CIC-IDS2018-v2', 'NF-ToN-IoT-v2', 'NF-UNSW-NB15-v2']
  📊 Using domains for training: ['NF-CSE-CIC-IDS2018-v2', 'NF-ToN-IoT-v2', 'NF-UNSW-NB15-v2']
  🎯 Target domain: NF-CSE-CIC-IDS2018-v2
  📦 Source domains: ['NF-ToN-IoT-v2', 'NF-UNSW-NB15-v2']
  Data directories: ['NF-ToN-IoT-v2', 'NF-UNSW-NB15-v2']
  
  Loading NF-ToN-IoT-v2:   0%|          | 0/169 [00:00<?, ?it/s]
  Loading NF-ToN-IoT-v2:  34%|███▎      | 57/169 [00:00<00:00, 566.54it/s]
  Loading NF-ToN-IoT-v2:  79%|███████▊  | 133/169 [00:00<00:00, 676.64it/s]
  Loading NF-ToN-IoT-v2: 100%|██████████| 169/169 [00:00<00:00, 705.00it/s]
  
  Loading NF-UNSW-NB15-v2:   0%|          | 0/23 [00:00<?, ?it/s]
  Loading NF-UNSW-NB15-v2: 100%|██████████| 23/23 [00:00<00:00, 983.02it/s]
  Data directories: ['NF-CSE-CIC-IDS2018-v2']
  
  Loading NF-CSE-CIC-IDS2018-v2:   0%|          | 0/187 [00:00<?, ?it/s]
  Loading NF-CSE-CIC-IDS2018-v2:  44%|████▍     | 83/187 [00:00<00:00, 823.25it/s]
  Loading NF-CSE-CIC-IDS2018-v2:  89%|████████▉ | 167/187 [00:00<00:00, 828.46it/s]
  Loading NF-CSE-CIC-IDS2018-v2: 100%|██████████| 187/187 [00:00<00:00, 836.96it/s]
  Train: 154, Val: 38, Test: 187
  ✅ Successfully loaded real datasets!
  🚂 Train batches: 39
  🔍 Val batches: 10
  🎯 Test batches: 47
  📊 Data shape: torch.Size([4, 100000, 39])
  🏷️  Labels shape: torch.Size([4, 100000])
  🌐 Domains shape: torch.Size([4, 100000])
  📈 Label distribution: tensor([170098, 229902])
  🗺️  Domain distribution: tensor([400000])
  
  🧠 Initializing model...
  ✅ Model initialized successfully!
  📊 Total parameters: 9,269
  🎯 Trainable parameters: 9,269
  
  ⚙️  Initializing optimizers and schedulers...
  ✅ Optimizer: SGD
  ✅ Scheduler: CosineAnnealingLR
  
  🚀 Starting training for 1 epochs...
  ================================================================================
  🎭 Demo mode: limiting to 5 batches per epoch
  ⠋      Overall                                                                                                                                                                  0%             0:00:00                    •      -:--:--
  
  
  ╭──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 📊 Training Metrics ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
  │ 🚀 Starting training...                                                                                                                                                                                                                                     │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯Error during training: running_mean should contain 100000 elements not 39
  
  -------------------------------------------------------------------------------
  main_config.py 618 <module>
  main()
  
  main_config.py 417 main
  model, optimizers, train_metrics = train(
  
  TrainEval.py 1133 train
  output_class, output_domain = model(data)
  
  module.py 1751 _wrapped_call_impl
  return self._call_impl(*args, **kwargs)
  
  module.py 1762 _call_impl
  return forward_call(*args, **kwargs)
  
  MoMLNIDS.py 34 forward
  invariant_features = self.FeatureExtractorLayer(x)
  
  module.py 1751 _wrapped_call_impl
  return self._call_impl(*args, **kwargs)
  
  module.py 1762 _call_impl
  return forward_call(*args, **kwargs)
  
  FeatureExtractor.py 34 forward
  x = self.norm(x)
  
  module.py 1751 _wrapped_call_impl
  return self._call_impl(*args, **kwargs)
  
  module.py 1762 _call_impl
  return forward_call(*args, **kwargs)
  
  batchnorm.py 193 forward
  return F.batch_norm(
  
  functional.py 2822 batch_norm
  return torch.batch_norm(
  
  RuntimeError:
  running_mean should contain 100000 elements not 39

--- 2025-07-14T14:41:58.455819 ---
ERROR: Quick training failed
DETAILS:
  Output:
  📁 Experiment Directory: Training_Sessions/ProperTraining_1Epochs_20250714_1441/NF-CSE-CIC-IDS2018-v2/|Demo|
  📂 Log Files: ['source_trained', 'val_performance', 'target_performance', 'clustering', 'training', 'final_val', 'final_target']
  Using device: cuda
  ================================================================================
  🚀 MoMLNIDS Training Configuration
  ================================================================================
  📊 Project: MoMLNIDS_Demo
  🎯 Target Index: 0 (NF-CSE-CIC-IDS2018-v2)
  🔬 Experiment: |Demo|
  📈 Epochs: 1
  📦 Batch Size: 4
  ⚡ Learning Rate: 0.001
  🧠 Model: Single Layer=True, Input Nodes=39
  🔄 Use Clustering: False
  💾 Models Dir: Training_Sessions/ProperTraining_1Epochs_20250714_1441/NF-CSE-CIC-IDS2018-v2/|Demo|
  📝 Logs Dir: Training_Sessions/ProperTraining_1Epochs_20250714_1441/NF-CSE-CIC-IDS2018-v2/|Demo|
  ================================================================================
  📂 Loading data from: ./data/parquet/
  ✅ Data path exists: data/parquet
  📁 Found NF-CSE-CIC-IDS2018-v2: 187 parquet files
  📁 Found NF-ToN-IoT-v2: 169 parquet files
  📁 Found NF-UNSW-NB15-v2: 23 parquet files
  🎯 Available datasets: ['NF-CSE-CIC-IDS2018-v2', 'NF-ToN-IoT-v2', 'NF-UNSW-NB15-v2']
  📊 Using domains for training: ['NF-CSE-CIC-IDS2018-v2', 'NF-ToN-IoT-v2', 'NF-UNSW-NB15-v2']
  🎯 Target domain: NF-CSE-CIC-IDS2018-v2
  📦 Source domains: ['NF-ToN-IoT-v2', 'NF-UNSW-NB15-v2']
  Data directories: ['NF-ToN-IoT-v2', 'NF-UNSW-NB15-v2']
  
  Loading NF-ToN-IoT-v2:   0%|          | 0/169 [00:00<?, ?it/s]
  Loading NF-ToN-IoT-v2:  34%|███▎      | 57/169 [00:00<00:00, 566.54it/s]
  Loading NF-ToN-IoT-v2:  79%|███████▊  | 133/169 [00:00<00:00, 676.64it/s]
  Loading NF-ToN-IoT-v2: 100%|██████████| 169/169 [00:00<00:00, 705.00it/s]
  
  Loading NF-UNSW-NB15-v2:   0%|          | 0/23 [00:00<?, ?it/s]
  Loading NF-UNSW-NB15-v2: 100%|██████████| 23/23 [00:00<00:00, 983.02it/s]
  Data directories: ['NF-CSE-CIC-IDS2018-v2']
  
  Loading NF-CSE-CIC-IDS2018-v2:   0%|          | 0/187 [00:00<?, ?it/s]
  Loading NF-CSE-CIC-IDS2018-v2:  44%|████▍     | 83/187 [00:00<00:00, 823.25it/s]
  Loading NF-CSE-CIC-IDS2018-v2:  89%|████████▉ | 167/187 [00:00<00:00, 828.46it/s]
  Loading NF-CSE-CIC-IDS2018-v2: 100%|██████████| 187/187 [00:00<00:00, 836.96it/s]
  Train: 154, Val: 38, Test: 187
  ✅ Successfully loaded real datasets!
  🚂 Train batches: 39
  🔍 Val batches: 10
  🎯 Test batches: 47
  📊 Data shape: torch.Size([4, 100000, 39])
  🏷️  Labels shape: torch.Size([4, 100000])
  🌐 Domains shape: torch.Size([4, 100000])
  📈 Label distribution: tensor([170098, 229902])
  🗺️  Domain distribution: tensor([400000])
  
  🧠 Initializing model...
  ✅ Model initialized successfully!
  📊 Total parameters: 9,269
  🎯 Trainable parameters: 9,269
  
  ⚙️  Initializing optimizers and schedulers...
  ✅ Optimizer: SGD
  ✅ Scheduler: CosineAnnealingLR
  
  🚀 Starting training for 1 epochs...
  ================================================================================
  🎭 Demo mode: limiting to 5 batches per epoch
  ⠋      Overall                                                                                                                                                                  0%             0:00:00                    •      -:--:--
  
  
  ╭──────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 📊 Training Metrics ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
  │ 🚀 Starting training...                                                                                                                                                                                                                                     │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  │                                                                                                                                                                                                                                                             │
  ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯Error during training: running_mean should contain 100000 elements not 39
  
  -------------------------------------------------------------------------------
  main_config.py 618 <module>
  main()
  
  main_config.py 417 main
  model, optimizers, train_metrics = train(
  
  TrainEval.py 1133 train
  output_class, output_domain = model(data)
  
  module.py 1751 _wrapped_call_impl
  return self._call_impl(*args, **kwargs)
  
  module.py 1762 _call_impl
  return forward_call(*args, **kwargs)
  
  MoMLNIDS.py 34 forward
  invariant_features = self.FeatureExtractorLayer(x)
  
  module.py 1751 _wrapped_call_impl
  return self._call_impl(*args, **kwargs)
  
  module.py 1762 _call_impl
  return forward_call(*args, **kwargs)
  
  FeatureExtractor.py 34 forward
  x = self.norm(x)
  
  module.py 1751 _wrapped_call_impl
  return self._call_impl(*args, **kwargs)
  
  module.py 1762 _call_impl
  return forward_call(*args, **kwargs)
  
  batchnorm.py 193 forward
  return F.batch_norm(
  
  functional.py 2822 batch_norm
  return torch.batch_norm(
  
  RuntimeError:
  running_mean should contain 100000 elements not 39

